<!DOCTYPE html>
<html lang="en">

<head>
  <title>Add Map</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

  <link rel="stylesheet" type="text/css" href="./style.css" />
  <script type="module" src="./index.js"></script>
  <style>
    #map {
      height: 500px;
      /* The height is 400 pixels */
      width: 500px;
      border: 1px, black;
      /* The width is the width of the web page */
    }

    .ai {
      margin-bottom: 5px;
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
</head>

<body>
  <nav class="navbar is-primary" role="navigation" aria-label="main navigation">

    <div class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/"> Safe Walk </a>

      </div>
      <div class="navbar-end">
        <p>xd</p>
      </div>
    </div>
  </nav>

  <br>
  <div class="container">
    <br>
    <!--The div element for the map -->
    <div class="columns">

      <div class="column">
        <div id="map"></div>
      </div>


      <div class="column">
        <p>Crime Stats</p>
        <p>Crime total for Annandale Campus 2022: {{ dictionary2['AN'] }}</p>
        <p>Crime total for Alexandria Campus 2022: {{ dictionary2['AL'] }}</p>
        <p>Crime total for Loudon Campus 2022: {{ dictionary2['LO'] }}</p>
        <p>Crime total for Woodbridge Campus 2022: {{ dictionary2['WO'] }}</p>
        <p>Crime total for Manassas Campus 2022: {{ dictionary2['MA'] }}</p>

        <p>Crime total for Medical Education Campus 2022: {{ dictionary2['MEC'] }}</p>
        <p>Crime total for Fairfax 2022: {{ dictionary2['Fairfax'] }}</p>

        <p>Crime total for Reston 2022: {{ dictionary2['Reston'] }}</p>
        <p>Crime total for Bookstore 2022: {{ dictionary2['Bookstore'] }}</p>

        <br>
        <hr>


        <form action="/" method="post">
          <p class="ai">AI Safety tips</p>

          <input type="text" name="crime" id="user-input" class="input"
            placeholder="Ask a question about 2022 NVCC crime data" value="" required>
          <input type="submit" class="button" value="Send" />
        </form>
        {% if result %}
        <div class="result">{{ result }}</div>
        {% endif %}


        <script>


          //   const apiUrl = 'https://api.openai.com/v1/engines/davinci-codex/completions'; // API endpoint
          //   const fixedPrompt = `${json} Answer questions of students about the NVCC crime data and offer advice about safety`;

          //   const chatLog = document.getElementById('chat-log');
          //   const userInput = document.getElementById('user-input');
          //   const sendButton = document.getElementById('send-button');

          //   // Initialize the chat with the fixed prompt
          //   appendMessage('ChatGPT', fixedPrompt);

          //   sendButton.addEventListener('click', () => {
          //     const userMessage = userInput.value;
          //     if (userMessage.trim() !== '') {
          //       appendMessage('You', userMessage);

          //       // Combine user message with the fixed prompt
          //       const combinedPrompt = `${fixedPrompt}\nUser: ${userMessage}`;

          //       // Send the combined prompt to ChatGPT API
          //       fetch(apiUrl, {
          //         method: 'POST',
          //         headers: {
          //           'Authorization': `Bearer ${apiKey}`,
          //           'Content-Type': 'application/json',
          //         },
          //         body: JSON.stringify({
          //           prompt: combinedPrompt,
          //           max_tokens: 50, // Adjust this as needed
          //         }),
          //       })
          //         .then(response => response.json())
          //         .then(data => {
          //           const chatGPTResponse = data.choices[0].text;
          //           appendMessage('ChatGPT', chatGPTResponse);
          //           console.log(chatGPTResponse)

          //         })
          //         .catch(error => console.error(error));

          //       userInput.value = ''; // Clear user input

          //     }
          //   });

          //   function appendMessage(sender, message) {
          //     const messageDiv = document.createElement('div');
          //     messageDiv.innerHTML = `<strong>${sender}:</strong> ${message}`;
          //     chatLog.appendChild(messageDiv);
          //   }

          // </script>

      </div>

    </div>


  </div>
  <div class="container">
    <p>table of contents</p>
    <a href="#crimeorder">
      <p>Show all crime descriptions ordered by frequency</p>
    </a>
    <a href="#allcrimes">
      <p>Show all crime data</p>
    </a>


    <h1>Raw data:</h1>
    <p>{{dictionary2 }}</p>
    <p id="crimeorder">All crimes ordered by frequency: {{reversed_dict}}</p>

    <p id="allcrimes">{{logsof2022}}</p>
  </div>



  </div>
  </div>

  <!-- <iframe allowfullscreen="allowfullscreen" aria-label="Google map of the Annandale  campus" frameborder="0"
    height="450"
    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3107.892990485302!2d-77.23637337398617!3d38.83491148874499!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89b64cf9b955ec95%3A0x18777b913206e477!2s8333+Little+River+Turnpike%2C+Annandale%2C+VA+22003!5e0!3m2!1sen!2sus!4v1540254420082"
    style="border: 0;" width="100%"></iframe> -->


  <!-- prettier-ignore -->
  <script>(g => { var h, a, k, p = "The Google Maps JavaScript API", c = "google", l = "importLibrary", q = "__ib__", m = document, b = window; b = b[c] || (b[c] = {}); var d = b.maps || (b.maps = {}), r = new Set, e = new URLSearchParams, u = () => h || (h = new Promise(async (f, n) => { await (a = m.createElement("script")); e.set("libraries", [...r] + ""); for (k in g) e.set(k.replace(/[A-Z]/g, t => "_" + t[0].toLowerCase()), g[k]); e.set("callback", c + ".maps." + q); a.src = `https://maps.${c}apis.com/maps/api/js?` + e; d[q] = f; a.onerror = () => h = n(Error(p + " could not load.")); a.nonce = m.querySelector("script[nonce]")?.nonce || ""; m.head.append(a) })); d[l] ? console.warn(p + " only loads once. Ignoring:", g) : d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)) })
      ({ key: "", v: "beta" });</script>
  <script>


    let map;

    async function initMap() {
      // The location of Uluru
      const position = { lat: 38.85834015397648, lng: - 77.31448709795391, };


      // Request needed libraries.
      //@ts-ignore
      const { Map } = await google.maps.importLibrary("maps");


      // The map, centered at Uluru
      map = new Map(document.getElementById("map"), {
        zoom: 10,
        center: position,
        mapId: "DEMO_MAP_ID",
      });

      const markerPositions = [
        position,
        { lat: 38.80919765585336, lng: -77.51840800369946, },
        { lat: 38.94867935022676, lng: -77.33252967855643, },
        { lat: 38.61785389183354, lng: -77.29447756323047 },
        { lat: 39.045385163235494, lng: -77.4010038655019, },
        { lat: 38.840471085801575, lng: -77.11389238258755, },
        { lat: 38.76366222523989, lng: -77.17640062698582, },
        { lat: 38.76366222523989, lng: -77.17640062698582, },
        { lat: 38.94854584744731, lng: -77.33248676321367 }

      ];

      // Create markers and add them to the map
      const markers = markerPositions.map(position => {
        return new google.maps.Marker({
          position: position,
          map: map,
        });
      });



    }

    initMap();
  </script>

</body>

</html>